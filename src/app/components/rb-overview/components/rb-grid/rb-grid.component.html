<p-table
	[value]="items()"
	[rowHover]="true"
	[scrollable]="true"
	scrollHeight="flex"
	[tableStyle]="{ 'min-width': '1000px' }"
>
	<ng-template pTemplate="header">
		<tr>
			<th style="width: 160px">Статус</th>
			<th>РБ</th>
			<th style="width: 280px">Время убийства</th>
			<th style="width: 140px">Мин. респ</th>
			<th style="width: 140px">Макс. респ</th>
			<th style="width: 220px">Таймер</th>
			<th style="width: 220px" class="text-left">Действия</th>
		</tr>
	</ng-template>

	<ng-template pTemplate="body" let-rb>
		<tr [ngClass]="getRowBgClass(rb)">
			<td>
				<p-tag
					[value]="getRowStatus(rb)"
					[severity]="getTagSeverity(rb)"
					class="dark:!bg-surface-900"
				/>
			</td>

			<td>
				<div class="font-medium text-surface-900 dark:text-surface-0">
					<span class="text-muted-color">[{{ rb?.lvl }}]</span>
					<span class="ml-2">{{ rb?.displayName }}</span>
				</div>
			</td>

			<td>
				<div class="flex items-center gap-2" (focusin)="beginEdit(rb)" (focusout)="endEdit($event)">
					<p-datepicker
						class="flex-1 w-full"
						[ngModel]="getDraftDeadTime(rb)"
						(ngModelChange)="onDeadTimeDraftChange(rb, $event)"
						[showTime]="true"
						[hourFormat]="'24'"
						[appendTo]="'body'"
					/>
					<p-button
						*ngIf="hasDeadTimeChanges(rb)"
						icon="pi pi-check"
						[text]="true"
						[severity]="'success'"
						[rounded]="true"
						ariaLabel="Save"
						(onClick)="commitDeadTime(rb)"
					></p-button>

					<p-button
						*ngIf="hasDeadTimeChanges(rb)"
						icon="pi pi-times"
						[text]="true"
						[severity]="'danger'"
						[rounded]="true"
						ariaLabel="Cancel"
						(onClick)="cancelDeadTime(rb)"
					></p-button>
				</div>
			</td>

			<td>
				{{ displayMinResp(rb) ? (displayMinResp(rb) | date : 'HH:mm' : 'Europe/Kyiv') : '—' }}
			</td>
			<td>
				{{ displayMaxResp(rb) ? (displayMaxResp(rb) | date : 'HH:mm' : 'Europe/Kyiv') : '—' }}
			</td>

			<td>
				<div class="text-sm">
					<div class="text-muted-color">{{ timeLeftLabel(rb) }}</div>
					@if (respElapsedLabel(rb) != null) {
						<div class="font-medium text-surface-900 dark:text-surface-0">{{ respElapsedLabel(rb) }}</div>
					} @else {
						<div class="font-medium text-surface-900 dark:text-surface-0">
							{{ timeLeft(rb) ? (timeLeft(rb) | date : 'HH:mm:ss') : '—' }}
						</div>
					}
				</div>
			</td>

			<td class="text-left">
				<div class="flex gap-2 justify-start">
					<p-button
						icon="pi pi-info-circle"
						[text]="true"
						[severity]="'secondary'"
						ariaLabel="Info"
						[disabled]="!rb?.meta?.infoLink"
						(onClick)="openInfoLink(rb)"
					></p-button>

					<p-button
						icon="pi pi-refresh"
						[text]="true"
						[severity]="'secondary'"
						ariaLabel="Refresh"
						(onClick)="setKillTimeNowKyiv(rb)"
					></p-button>
				</div>
			</td>
		</tr>
	</ng-template>

	<ng-template pTemplate="emptymessage">
		<tr>
			<td [attr.colspan]="7" class="text-center text-muted-color p-4">
				Нет данных
			</td>
		</tr>
	</ng-template>
</p-table>
